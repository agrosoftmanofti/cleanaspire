@inject OfflineSyncService OfflineSyncService

<div class="d-flex justify-center align-center flex-row gap-2">
    @if (OfflineSyncService.CurrentStatus == SyncStatus.Idle)
    {
        <MudIcon>
            <svg width="24" height="24" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" version="1.1">
                <!-- 第1个圆点 (蓝色) -->
                <circle cx="50" cy="30" r="5" fill="#3498db">
                    <animate attributeName="r" values="5;7;5" dur="1.2s" repeatCount="indefinite" begin="0s" />
                </circle>

                <!-- 第2个圆点 (红色) -->
                <circle cx="50" cy="50" r="5" fill="#e74c3c">
                    <animate attributeName="r" values="5;7;5" dur="1.2s" repeatCount="indefinite" begin="0.2s" />
                </circle>

                <!-- 第3个圆点 (黄色) -->
                <circle cx="50" cy="70" r="5" fill="#f1c40f">
                    <animate attributeName="r" values="5;7;5" dur="1.2s" repeatCount="indefinite" begin="0.4s" />
                </circle>

                <!-- 第4个圆点 (绿色) -->
                <circle cx="50" cy="90" r="5" fill="#2ecc71">
                    <animate attributeName="r" values="5;7;5" dur="1.2s" repeatCount="indefinite" begin="0.6s" />
                </circle>
            </svg>
        </MudIcon>
    }
    else if (OfflineSyncService.CurrentStatus == SyncStatus.Completed)
    {
        <MudText Typo="Typo.caption">@OfflineSyncService.StatusMessage</MudText>
        <MudIcon>
            <svg width="24" height="24" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <!-- 绿色圆圈边框 -->
                <circle cx="50" cy="50" r="45" stroke="#2ecc71" stroke-width="8" fill="none">
                    <!-- 动画：逐渐画出圆圈 -->
                    <animate attributeName="stroke-dasharray" from="0, 283" to="283, 283" dur="1s" fill="freeze" />
                </circle>

                <!-- 对勾路径 -->
                <path d="M30 50 L45 65 L70 35" stroke="#2ecc71" stroke-width="8" fill="none" stroke-linecap="round" stroke-linejoin="round"
                      stroke-dasharray="50, 50" stroke-dashoffset="50">
                    <!-- 动画：逐渐画出对勾 -->
                    <animate attributeName="stroke-dashoffset" from="50" to="0" dur="0.8s" begin="1s" fill="freeze" />
                </path>
            </svg>
        </MudIcon>
    }else
    {
        <MudText Typo="Typo.caption">@OfflineSyncService.StatusMessage</MudText>
        <MudIcon>
            <svg width="24" height="24" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" transform="matrix(-1.8369701987210297e-16,-1,1,-1.8369701987210297e-16,0,0)">
                <!-- 第1个圆点 (蓝色) -->
                <circle cx="50" cy="20" r="7" fill="#3498db">
                    <animateTransform attributeType="XML" attributeName="transform" type="rotate" from="0 50 50" to="360 50 50" dur="1.5s" repeatCount="indefinite"></animateTransform>
                </circle>

                <!-- 第2个圆点 (红色) -->
                <circle cx="80" cy="50" r="7" fill="#e74c3c">
                    <animateTransform attributeType="XML" attributeName="transform" type="rotate" from="0 50 50" to="360 50 50" dur="1.5s" begin="0.2s" repeatCount="indefinite"></animateTransform>
                </circle>

                <!-- 第3个圆点 (黄色) -->
                <circle cx="50" cy="80" r="7" fill="#f1c40f">
                    <animateTransform attributeType="XML" attributeName="transform" type="rotate" from="0 50 50" to="360 50 50" dur="1.5s" begin="0.4s" repeatCount="indefinite"></animateTransform>
                </circle>

                <!-- 第4个圆点 (绿色) -->
                <circle cx="20" cy="50" r="7" fill="#2ecc71">
                    <animateTransform attributeType="XML" attributeName="transform" type="rotate" from="0 50 50" to="360 50 50" dur="1.5s" begin="0.6s" repeatCount="indefinite"></animateTransform>
                </circle>
            </svg>
        </MudIcon>
    }
</div>

@code {
    protected override void OnInitialized()
    {
        OfflineSyncService.OnSyncStateChanged += StateHasChanged;
    }

    public void Dispose()
    {
        OfflineSyncService.OnSyncStateChanged -= StateHasChanged;
    }

    
}
